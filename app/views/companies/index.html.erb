<p id="notice" style="margin-left:80px"><%= notice %></p>

<div style = "text-align: center">
  <font size="5px" color=maroon><strong><%= "Company List(Administrative View)"%></strong></font><br><br>
  </div>

<div id="ABComp" style="margin-left:120px">
  <div>
    <font size="3.2px"><strong><%= link_to 'New Company', new_company_path %>
    &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
    <%= link_to 'Back', sessions_url %></strong></font><br>
  </div>

  <p><strong>Representives registered for lunch:
  <%= @lunch_total%></strong>
  </p>
</div>


<table align="center" border="3px" cellspacing="0px">
  <thead>
    <tr>
      <th>Name</th>
      <th>Contact Person</th>
      <th>Contact Email</th>
      <th>Sponsor Level</th>
      <th>Citizenship</th>
      <th>Job Type</th>
      <th>Student Level</th>
      <th>Rep 1 Name</th>
      <th>Rep 2 Name</th>
      <th>Rep 3 Name</th>
      <th>Rep 4 Name</th>
      <th>Rep 5 Name</th>
      <th>Rep 6 Name</th>
      <% Event.pluck(:name).each do |name| %>
        <th><%= name %> #</th>
      <% end %>
      <th colspan="3">Operation</th>
    </tr>
  </thead>

  <tbody>
    <% @companies.each do |company| %>
      <tr>
        <td><%= company.name %></td>
        <td><%= company.contact_person %></td>
        <td><%= company.contact_email %></td>
        <td><%= company.sponsor_level %></td>
        <td><%= company.citizenship %></td>
        <td><%= company.job_type %></td>
        <td><%= company.student_level %></td>
        <td><%= company.rep_1 %></td>
        <td><%= company.rep_2 %></td>
        <td><%= company.rep_3 %></td>
        <td><%= company.rep_4 %></td>
        <td><%= company.rep_5 %></td>
        <td><%= company.rep_6 %></td>
        <% company.events.each do |e| %>
          <td><%= company.companyevents.where(company_id: company.id, event_id: e.id).to_yaml.match(/representatives: [ \t]*([^\n\r]*)/).to_s.match(/'(.*)'/).to_s.gsub("'","") %></td>
        <% end %>
        <td><%= link_to 'Show', company %></td>
        <td><%= link_to 'Edit', edit_company_path(company) %></td>
        <td><%= link_to 'Destroy', company, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
